<div id="container-instructions">
  <h1>Instructions</h1>
  <hr>
  <div class="instructions well">
    <p>
    As the experiment proceeds, the elephant will tell his story one sentence
    at a time. Click the elephant below to see a few sentences in a row.
    </p>
    <div style="overflow: hidden">
      <div class="elephant">
        <svg width=160 height=160>
          <image xlink:href="static/images/elephant.svg"
            width=120 height=120 y=40 />
        </svg>
      </div>
      <div class="cow">
        <svg width="160" height="160">
          <image xlink:href="static/images/cow.svg"
            width="160" height="120" y=40 />
        </svg>
      </div>
      <div class="stim" style="margin-left: 0; margin-top: 0;">
      </div>
    </div>
  </div>
	<hr>
  <div class="instructionsnav">
    <div class="row">
      <div class="col-xs-2">
        <button type="button" id="next" value="next"
          class="btn btn-primary btn-lg previous">
          <span class="glyphicon glyphicon-arrow-left"></span> Previous
        </button>
      </div>
        <div class="col-xs-8">
        </div>
      <div class="col-xs-2">
        <button type="button" id="next" value="next"
          class="btn btn-primary btn-lg continue">
          Next <span class="glyphicon glyphicon-arrow-right"></span>
        </button>
      </div>
    </div>
  <script type="text/javascript">
    var demo_syl_code = ["wao", "yai", "piu", "shin", "bam", "fei", "ti", "ra", "ki"];
    var demosyl = function(bubble, syl) {
      var s = demo_syl_code[syl] || " ";
      bubble.append("div")
            .append("p")
            .text(s);
    };
    var democlear = function(bubble) {
      bubble.selectAll("div").remove();
    };
    var demofreebie = function(bubble, elephant, sequence, stim_array) {
      var fix = setInterval(function() {
        democlear(bubble);
        if (_.isEmpty(sequence)) {
          clearInterval(fix);
          doDemo(bubble, elephant, stim_array);
        } else {
          var syl = sequence.shift();
          demosyl(bubble, syl);
        }
      }, 250);
      return fix;
    };
    var doDemo = function(bubble, elephant, stim_array) {
      if (stim_array.length > 0) {
        var sequence = stim_array.shift();
        democlear(bubble);
        /* clearDrawer(drawer); */
        demosyl(bubble, -1);
        setTimeout(function() {
          demofreebie(bubble, elephant, sequence, stim_array);
        }, 500);
      }
    };
    var el = d3.select(".elephant");
    var sb = d3.select(".stim");
    el.on("click", function() {
      doDemo(sb, el, [[0,1,2,3], [2,1,3,0]]);
    });
  </script>
</div>
